{% extends 'base_layout.html' %}

{% block content %}
    {% load staticfiles %}
    <link rel="stylesheet" href="{% static 'bower_components/product/product.css' %} ">
    <link rel="stylesheet" href="{% static 'cart/bootstrap.min.css' %} ">
    <script src="{% static 'cart/jquery-2.2.3.min.js' %}"></script>
    <script src="{% static 'cart/jquery.mycart.js' %}"></script>
    <script src="{% static 'cart/bootstrap.min.js' %}"></script>


    <section class="content">

        <!-- /.row -->
        <!-- Main row -->
        <div class="row">
            <style>
                .badge-notify {
                    background: red;
                    position: relative;
                    top: -20px;
                    right: 10px;
                }

                .my-cart-icon-affix {
                    position: fixed;
                    z-index: 999;
                }
            </style>

            <section class="col-lg-12 ">


                <div class="box-body">


                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <h3 class="box-title">Araç Temizlik Ürünleri</h3>
                        </div>
                        <div style="float: right; cursor: pointer;">
                            <span class="glyphicon glyphicon-shopping-cart my-cart-icon"><span
                                    class="badge badge-notify my-cart-badge"></span></span>
                        </div>


                        <div class="container">


                            <div class="row">


                                {% if products.all %}
                                    {% for product in products %}


                                        <div class="col-md-3 text-center">
                                            <img src="/media/{{ product.productImage }}" height="200" width="200">
                                            <br>
                                            {{ product.name }} <br> <strong>{{ product.discountPrice }} TL</strong>
                                            <br>
                                            <button class="btn btn-danger my-cart-btn" data-id="{{ product.id }}"
                                                    data-name="{{ product.name }}"
                                                    data-summary="{{ product.name }}" data-price="{{ product.discountPrice }}"
                                                    data-quantity="1"
                                                    data-image="/media/{{ product.productImage }}">Sepete Ekle
                                            </button>
                                            <a href="#" class="btn btn-info">Detaylar</a>
<br> <br>
                                        </div>





                                    {% endfor %}
                                {% endif %}


                            </div>
                        </div>

                    </div>
                </div>


            </section>


        </div>
        <!-- /.row (main row) -->

    </section>






    <script type="text/javascript">
        $(function () {

            var goToCartIcon = function ($addTocartBtn) {
                var $cartIcon = $(".my-cart-icon");
                var $image = $('<img width="30px" height="30px" src="' + $addTocartBtn.data("image") + '"/>').css({
                    "position": "fixed",
                    "z-index": "999"
                });
                $addTocartBtn.prepend($image);
                var position = $cartIcon.position();
                $image.animate({
                    top: position.top,
                    left: position.left
                }, 500, "linear", function () {
                    $image.remove();
                });
            }

            $('.my-cart-btn').myCart({
                currencySymbol: '₺',
                classCartIcon: 'my-cart-icon',
                classCartBadge: 'my-cart-badge',
                classProductQuantity: 'my-product-quantity',
                classProductRemove: 'my-product-remove',
                classCheckoutCart: 'my-cart-checkout',
                affixCartIcon: true,
                showCheckoutModal: true,
                numberOfDecimals: 2,
                cartItems: [],
                clickOnAddToCart: function ($addTocart) {
                    goToCartIcon($addTocart);
                },
                afterAddOnCart: function (products, totalPrice, totalQuantity) {
                    console.log("afterAddOnCart", products, totalPrice, totalQuantity);
                },
                clickOnCartIcon: function ($cartIcon, products, totalPrice, totalQuantity) {
                    console.log("cart icon clicked", $cartIcon, products, totalPrice, totalQuantity);
                },
                checkoutCart: function (products, totalPrice, totalQuantity) {
                    var checkoutString = "Total Price: " + totalPrice + "\nTotal Quantity: " + totalQuantity;
                    checkoutString += "\n\n id \t name \t summary \t price \t quantity \t image path";
                    $.each(products, function () {
                        checkoutString += ("\n " + this.id + " \t " + this.name + " \t " + this.summary + " \t " +
                            this.price + " \t " + this.quantity + " \t " + this.image);
                    });
                    alert(checkoutString)
                    console.log("checking out", products, totalPrice, totalQuantity);
                },
                getDiscountPrice: function (products, totalPrice, totalQuantity) {
                    console.log("calculating discount", products, totalPrice, totalQuantity);
                    return totalPrice * 0.5;
                }
            });

            $("#addNewProduct").click(function (event) {
                var currentElementNo = $(".row").children().length + 1;
                $(".row").append('<div class="col-md-3 text-center"><img src="images/img_empty.png" width="150px" height="150px">' +
                    '<br>product ' + currentElementNo + ' - <strong>$' + currentElementNo + '</strong><br>' +
                    '<button class="btn btn-danger my-cart-btn" data-id="' + currentElementNo + '" data-name="product ' + currentElementNo
                    + '" data-summary="summary ' + currentElementNo + '" data-price="' + currentElementNo + '" data-quantity="1" ' +
                    'data-image="images/img_empty.png">Add to Cart</button><a href="#" class="btn btn-info">Details</a></div>')
            });
        });
    </script>




{% endblock %}

